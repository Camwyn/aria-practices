<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrollable Listbox Example</title>

    <!-- Core JS and CSS shared by all examples -->
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css">
    <link rel="stylesheet" href="../../../shared/css/core.css">
    <script src="../../../shared/js/examples.js"></script>
    <script src="../../../shared/js/highlight.pack.js"></script>
    <script src="../../../shared/js/app.js"></script>
    <script src="../../../shared/js/skipto.js"></script>

    <!-- JS and CSS for this example -->
    <link href="css/listbox.css" rel="stylesheet">
    <script src="js/listbox.js"></script>
    <script src="js/listbox-scrollable.js"></script>
  </head>
  <body>
    <nav aria-label="Related Links" class="feedback">
      <ul>
        <li><a href="https://github.com/w3c/aria-practices/projects/13">Related Issues</a></li>
        <li><a href="../listbox-pattern.html">Design Pattern</a></li>
      </ul>
    </nav>
    <main>
      <h1>Scrollable Listbox Example</h1>

      <section>
        <h2>About This Example</h2>
        <p>
          The following example implementation of the <a href="../listbox-pattern.html">Listbox Pattern</a> demonstrates a scrollable single-select listbox widget.
          This widget is functionally similar to an HTML <code>select</code> input where the <code>size</code> attribute has a value greater than one.
        </p>
        <p>Similar examples include:</p>
        <ul>
          <li><a href="listbox-rearrangeable.html">Example Listboxes with Rearrangeable Options</a>: Examples of both single-select and multi-select listboxes with accompanying toolbars where options can be added, moved, and removed.</li>
          <li><a href="listbox-grouped.html">Listbox Example with Grouped Options</a>: Single-select listbox with grouped options, similar to an HTML <code>select</code> with <code>optgroup</code> children.</li>
        </ul>
      </section>

      <section>
        <div class="example-header">
          <h2 id="ex_label">Example</h2>
        </div>
        <div role="separator" id="ex_start_sep" aria-labelledby="ex_start_sep ex_label" aria-label="Start of"></div>
        <div id="ex">
          <p>Choose your favorite transuranic element (actinide or transactinide).</p>
          <div class="listbox-area">
            <div>
              <span id="ss_elem" class="listbox-label">Transuranium elements:</span>
              <ul id="ss_elem_list" tabindex="0" role="listbox" aria-labelledby="ss_elem">
                <li id="ss_elem_Np" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Neptunium
                </li>
                <li id="ss_elem_Pu" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Plutonium
                </li>
                <li id="ss_elem_Am" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Americium
                </li>
                <li id="ss_elem_Cm" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Curium
                </li>
                <li id="ss_elem_Bk" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Berkelium
                </li>
                <li id="ss_elem_Cf" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Californium
                </li>
                <li id="ss_elem_Es" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Einsteinium
                </li>
                <li id="ss_elem_Fm" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Fermium
                </li>
                <li id="ss_elem_Md" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Mendelevium
                </li>
                <li id="ss_elem_No" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Nobelium
                </li>
                <li id="ss_elem_Lr" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Lawrencium
                </li>
                <li id="ss_elem_Rf" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Rutherfordium
                </li>
                <li id="ss_elem_Db" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Dubnium
                </li>
                <li id="ss_elem_Sg" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Seaborgium
                </li>
                <li id="ss_elem_Bh" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Bohrium
                </li>
                <li id="ss_elem_Hs" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Hassium
                </li>
                <li id="ss_elem_Mt" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Meitnerium
                </li>
                <li id="ss_elem_Ds" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Darmstadtium
                </li>
                <li id="ss_elem_Rg" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Roentgenium
                </li>
                <li id="ss_elem_Cn" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Copernicium
                </li>
                <li id="ss_elem_Nh" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Nihonium
                </li>
                <li id="ss_elem_Fl" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Flerovium
                </li>
                <li id="ss_elem_Mc" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Moscovium
                </li>
                <li id="ss_elem_Lv" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Livermorium
                </li>
                <li id="ss_elem_Ts" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Tennessine
                </li>
                <li id="ss_elem_Og" role="option">
                  <span class="checkmark" aria-hidden="true"></span>
                  Oganesson
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div role="separator" id="ex_end_sep" aria-labelledby="ex_end_sep ex_label" aria-label="End of"></div>
      </section>

      <section>
        <h2>Notes</h2>
        <p>This listbox is scrollable; it has more options than its height can accommodate.</p>
        <ul>
          <li>
            Scrolling only works as expected if the listbox is the options' <code>offsetParent</code>.
            The example uses <code>position: relative</code> on the listbox to that effect.
          </li>
          <li>
            When an option is focused that isn't (fully) visible, the listbox's scroll position is updated:
            <ul>
              <li>If <kbd>Up Arrow</kbd> or <kbd>Down Arrow</kbd> is pressed, the previous or next option is scrolled into view.</li>
              <li>If <kbd>Home</kbd> or <kbd>End</kbd> is pressed, the listbox scrolls all the way to the top or to the bottom.</li>
              <li>If <code>focusItem</code> is called, the focused option will be scrolled to the top of the view if it was located above it or to the bottom if it was below it.</li>
              <li>If the mouse is clicked on a partially visible option, it will be scrolled fully into view.</li>
            </ul>
          </li>
          <li>When a fully visible option is focused in any way, no scrolling occurs.</li>
          <li>
            Normal scrolling through any scrolling mechanism (including <kbd>Page Up</kbd> and <kbd>Page Down</kbd>) works as expected.
            The scroll position will jump as described for <code>focusItem</code> if a means other than a mouse click is used to change focus after scrolling.
          </li>
        </ul>
      </section>

      <section  id="accessibility_features">
        <h2>Accessibility Features</h2>
        <ul>
          <li>
            Browsers do not manage visibility of elements referenced by <code>aria-activedescendant</code> like they do for elements with focus.
            When a keyboard event changes the active option in the listbox, the JavaScript scrolls the option referenced by <code>aria-activedescendant</code> into view.
            Managing <code>aria-activedescendant</code> visibility is essential to accessibility for people who use a browser's zoom feature to increase the size of content.
          </li>
          <li>
            To enhance perceivability when operating the listbox, visual keyboard focus and hover are styled using the CSS <code>:hover</code> and <code>:focus</code> pseudo-classes:
            <ul>
              <li>To help people with visual impairments identify the listbox as an interactive element, the cursor is changed to a pointer when hovering over the list.</li>
              <li>To make it easier to distinguish the selected listbox option from other options, selection creates a 2 pixel border above and below the option.</li>
            </ul>
          </li>
        </ul>
      </section>

      <section>
        <h2 id="kbd_label">Keyboard Support</h2>
        <p>
          The example listbox on this page implements the following keyboard interface.
          Other variations and options for the keyboard interface are described in the <a href="../listbox-pattern.html#keyboard_interaction">Keyboard Interaction section of the Listbox Pattern</a>.
        </p>
        <table aria-labelledby="kbd_label" class="def">
          <thead>
            <tr>
              <th>Key</th>
              <th>Function</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="key-down-arrow">
              <th><kbd>Down Arrow</kbd></th>
              <td>Moves focus to and selects the next option.</td>
            </tr>
            <tr data-test-id="key-up-arrow">
              <th><kbd>Up Arrow</kbd></th>
              <td>Moves focus to and selects the previous option.</td>
            </tr>
            <tr data-test-id="key-home">
              <th><kbd>Home</kbd></th>
              <td>Moves focus to and selects the first option.</td>
            </tr>
            <tr data-test-id="key-end">
              <th><kbd>End</kbd></th>
              <td>Moves focus to and selects the last option.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2 id="rps_label">Role, Property, State, and Tabindex Attributes</h2>
        <p>
          The example listbox on this page implements the following ARIA roles, states, and properties.
          Information about other ways of applying ARIA roles, states, and properties is available in the <a href="../listbox-pattern.html#roles_states_properties">Roles, States, and Properties section of the Listbox Pattern</a>.
        </p>
        <table aria-labelledby="rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">Role</th>
              <th scope="col">Attribute</th>
              <th scope="col">Element</th>
              <th scope="col">Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="listbox-role">
              <th scope="row"><code>listbox</code></th>
              <td></td>
              <td><code>ul</code></td>
              <td>Identifies the focusable element that has listbox behaviors and contains the listbox options.</td>
            </tr>
            <tr data-test-id="listbox-aria-labelledby">
              <td></td>
              <th scope="row"><code>aria-labelledby=&quot;ID_REF&quot;</code></th>
              <td><code>ul</code></td>
              <td>Refers to the element containing the listbox label.</td>
            </tr>
            <tr data-test-id="listbox-tabindex">
              <td></td>
              <th scope="row"><code>tabindex=&quot;0&quot;</code></th>
              <td><code>ul</code></td>
              <td>Includes the listbox in the page tab sequence.</td>
            </tr>
            <tr data-test-id="listbox-aria-activedescendant">
              <td></td>
              <th scope="row"><code>aria-activedescendant=&quot;ID_REF&quot;</code></th>
              <td><code>ul</code></td>
              <td>
                <ul>
                  <li>Tells assistive technologies which of the options, if any, is visually indicated as having keyboard focus.</li>
                  <li>DOM focus remains on the <code>ul</code> element and the idref specified for <code>aria-activedescendant</code> refers to the <code>li</code> element that is visually styled as focused.</li>
                  <li>When navigation keys, such as <kbd>Down Arrow</kbd>, are pressed, the JavaScript changes the value.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="option-role">
              <th scope="row"><code>option</code></th>
              <td></td>
              <td><code>li</code></td>
              <td>Identifies each selectable element containing the name of an option.</td>
            </tr>
            <tr data-test-id="option-aria-selected">
              <td></td>
              <th scope="row"><code>aria-selected=&quot;true&quot;</code></th>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li>Indicates that the option is selected.</li>
                  <li>Applied to the element with role option that is visually styled as selected.</li>
                  <li>The option with this attribute is always the same as the option that is referenced by aria-activedescendant because it is a single-select listbox where selection follows focus.</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="span-aria-hidden">
              <td></td>
              <th><code>aria-hidden=&quot;true&quot;</code></th>
              <td><code>span</code></td>
              <td>
                Removes the character entity used for the check mark icon from the accessibility tree to prevent it from being included in the accessible name of the option.
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2>Javascript and CSS Source Code</h2>
        <ul id="css_js_files">
          <li>
            CSS:
            <a href="css/listbox.css" type="tex/css">listbox.css</a>
          </li>
          <li>
            Javascript:
            <a href="js/listbox.js" type="text/javascript">listbox.js</a>, <a href="js/listbox-scrollable.js" type="text/javascript">listbox-scrollable.js</a>
          </li>
        </ul>
      </section>

      <section>
        <h2 id="sc_label">HTML Source Code</h2>
        <div id="sc_start_sep" role="separator" aria-labelledby="sc_start_sep sc_label" aria-label="Start of "></div>
        <pre><code id="sc1"></code></pre>
        <div id="sc_end_sep" role="separator" aria-labelledby="sc_end_sep sc_label" aria-label="End of"></div>
        <script>
          sourceCode.add('sc1', 'ex', 'ex_label', 'css_js_files');
          sourceCode.make();
        </script>
      </section>
    </main>
  </body>
</html>
